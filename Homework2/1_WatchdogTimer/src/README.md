# 看门狗定时器（Watchdog Timer）多线程实现

## 项目概述

本项目实现了一个基于Java多线程的看门狗定时器机制。看门狗定时器是一种常用于监控系统运行状态的机制，可以检测系统是否正常运行，如果发现异常，可以采取相应的措施（如报警、重启等）。

## 实现要求

1. 启动A线程执行主要工作的同时，它会定时（每3秒）将watchdog变量的值修改成1
2. 启动B线程每1秒去监测watchdog变量，如果它的值为1，则修改成0
3. 如果B线程连续10次读到零就判断A线程出错，打印报警信息
4. 选做部分：当B发现A出错时重新启动A线程

## 实现原理

### 共享变量

所有实现都使用了一个共享的`watchdog`变量作为线程间通信的媒介。为了保证多线程环境下的可见性，该变量被声明为`volatile`。

### 线程A（工作线程）

- 执行主要工作（在示例中用简单的计数模拟）
- 每3秒将watchdog变量设置为1
- 在运行一段时间后模拟出错情况（停止更新watchdog变量）

### 线程B（监控线程）

- 每1秒检查一次watchdog变量
- 如果值为1，则重置为0并重置计数器
- 如果值为0，则增加计数器
- 如果连续10次读到0，则判断线程A出错，打印报警信息
- 在可重启版本中，还会尝试重启线程A

## 运行说明

可以通过以下命令编译并运行各个版本：

```bash
# 编译
javac Homework2/WatchdogTimer/*.java

# 运行基础版本
java Homework2.WatchdogTimer.WatchdogTimerDemo

# 运行可重启版本
java Homework2.WatchdogTimer.RestartableWatchdogTimer
```

## 各版本特点

### WatchdogTimerDemo

- 基础实现，所有逻辑都在main方法中
- 实现了基本的看门狗定时器功能
- 包含了选做部分的重启功能

### RestartableWatchdogTimer

- 可重启版实现，专注于实现选做部分的功能
- 使用线程工厂模式创建工作线程
- 支持在检测到错误时重启工作线程

## 注意事项

- 所有版本都使用了`volatile`关键字确保多线程环境下变量的可见性
- 在可重启版本中，使用了数组来存储线程引用，以便在lambda表达式中修改
- 监控线程被设置为守护线程，当主线程结束时，监控线程也会自动结束 